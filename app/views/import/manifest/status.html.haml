- page_title "Manifest import"
- header_title "Projects", root_path
- provider = 'manifest'

%h3.page-title
  = icon('git')
  = _('Import multiple repositories')

%p
  = button_tag class: "btn btn-import btn-success js-import-all" do
    = import_all_githubish_repositories_button_label
    = icon("spinner spin", class: "loading-icon")

.table-responsive
  %table.table.import-jobs
    %colgroup.import-jobs-from-col
    %colgroup.import-jobs-to-col
    %colgroup.import-jobs-status-col
    %thead
      %tr
        %th= _('Repository URL')
        %th= _('To GitLab')
        %th= _('Status')
    %tbody
      - @already_added_projects.each do |project|
        %tr{ id: "project_#{project.id}", class: "#{project_status_css_class(project.import_status)}" }
          %td
            = link_to_project project
          %td
            = project.import_url
          %td.job-status
            - if project.import_status == 'finished'
              %span
                = icon('check')
                = _('Done')
            - elsif project.import_status == 'started'
              = icon("spinner spin")
              = _('Started')
            - elsif project.import_status == 'failed'
              = _('Failed')
            - else
              = project.human_import_status_name

      - @repos.each do |repo|
        %tr{ id: "repo_#{repo[:id]}" }
          %td
            = repo[:url]
          %td.import-target
            = import_project_target(@group.path, repo[:path])
          %td.import-actions.job-status
            = button_tag class: "btn btn-import js-add-to-import" do
              Import
              = icon("spinner spin", class: "loading-icon")

.js-importer-status{ data: { jobs_import_path: "#{url_for([:jobs, :import, provider])}",
                             import_path: "#{url_for([:import, provider])}",
                             ci_cd_only: "#{has_ci_cd_only_params?}" } }
